
> @game/server@0.0.0 dev /Users/mbp/Development/el-dorado-tanstack/apps/server
> tsx src/index.ts

OpenTelemetry initialized
{"timestamp":"2025-11-27T17:17:13.753Z","level":"info","message":"server listening","gameId":null,"playerId":null,"eventIndex":null,"context":{"host":"localhost","port":4000},"traceId":null,"spanId":null}
{"timestamp":"2025-11-27T17:17:27.434Z","level":"info","message":"game created","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"room-registry","minPlayers":4,"maxPlayers":4,"roundCount":1,"isPublic":false,"hostIsBot":false},"traceId":"4197dbe7657c8a4e2a05121dba348dea","spanId":"b18b438503df4873"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '4197dbe7657c8a4e2a05121dba348dea',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'http.request',
  id: 'b18b438503df4873',
  kind: 0,
  timestamp: 1764263847295000,
  duration: 141230.625,
  attributes: {
    'http.method': 'POST',
    'http.target': '/api/create-room',
    'http.response.status_code': 201,
    'http.route': '/api/create-room'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:27.439Z","level":"info","message":"http request handled","gameId":null,"playerId":null,"eventIndex":null,"context":{"component":"http-server","method":"POST","path":"/api/create-room","statusCode":201,"durationMs":146.0535},"traceId":null,"spanId":null}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '539578bcf0956f9e6c1e6f9ed06cc299',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'http.request',
  id: '61d655e36c6c776f',
  kind: 0,
  timestamp: 1764263847493000,
  duration: 17128.875,
  attributes: {
    'http.method': 'POST',
    'http.target': '/api/join-by-code',
    'http.response.status_code': 200,
    'http.route': '/api/join-by-code'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:27.512Z","level":"info","message":"http request handled","gameId":null,"playerId":null,"eventIndex":null,"context":{"component":"http-server","method":"POST","path":"/api/join-by-code","statusCode":200,"durationMs":19.246292},"traceId":null,"spanId":null}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '088e3ee8b59f7cc1a95574287a771acd',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'http.request',
  id: 'a1028c3add9c1b59',
  kind: 0,
  timestamp: 1764263847753000,
  duration: 22586.292,
  attributes: {
    'http.method': 'POST',
    'http.target': '/api/join-by-code',
    'http.response.status_code': 200,
    'http.route': '/api/join-by-code'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:27.777Z","level":"info","message":"http request handled","gameId":null,"playerId":null,"eventIndex":null,"context":{"component":"http-server","method":"POST","path":"/api/join-by-code","statusCode":200,"durationMs":24.500084},"traceId":null,"spanId":null}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'dcac0eb812002f5d156ed5b757f4f2a1',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'http.request',
  id: 'e0a2ca67603f2bf5',
  kind: 0,
  timestamp: 1764263847989000,
  duration: 18649.291,
  attributes: {
    'http.method': 'POST',
    'http.target': '/api/join-by-code',
    'http.response.status_code': 200,
    'http.route': '/api/join-by-code'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:28.008Z","level":"info","message":"http request handled","gameId":null,"playerId":null,"eventIndex":null,"context":{"component":"http-server","method":"POST","path":"/api/join-by-code","statusCode":200,"durationMs":19.368667},"traceId":null,"spanId":null}
{"timestamp":"2025-11-27T17:17:28.463Z","level":"info","message":"ws connected","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":null,"context":{"component":"ws-gateway","socketId":"6a3432c8-ef21-4210-af1f-607c466fcddc","seatIndex":0},"traceId":null,"spanId":null}
{"timestamp":"2025-11-27T17:17:28.524Z","level":"info","message":"ws connected","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":null,"context":{"component":"ws-gateway","socketId":"e141da2f-567e-494e-a41c-fbe9d8eb7415","seatIndex":1},"traceId":null,"spanId":null}
{"timestamp":"2025-11-27T17:17:28.784Z","level":"info","message":"ws connected","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":null,"context":{"component":"ws-gateway","socketId":"edf3a5fd-c930-4d1c-bffc-3504ae8578d6","seatIndex":2},"traceId":null,"spanId":null}
{"timestamp":"2025-11-27T17:17:29.014Z","level":"info","message":"ws connected","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":null,"context":{"component":"ws-gateway","socketId":"d0995e7c-a66c-409c-b111-87c697ee8ecb","seatIndex":3},"traceId":null,"spanId":null}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '56216cc3234c81706be2403d21dee0d2',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'faa21370cd2ebac0',
  kind: 0,
  timestamp: 1764263850478000,
  duration: 709.5,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'SET_READY_OVERRIDE'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:30.976Z","level":"info","message":"handleStartGame called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b0b2910c1cc784d261975b9ba1ee87b9","spanId":"f3bf3573c57b842e"}
{"timestamp":"2025-11-27T17:17:30.976Z","level":"info","message":"validateLobbyStart check","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway","activePlayers":4,"minPlayers":4,"override":true},"traceId":"b0b2910c1cc784d261975b9ba1ee87b9","spanId":"f3bf3573c57b842e"}
{"timestamp":"2025-11-27T17:17:30.976Z","level":"info","message":"validateLobbyStart result","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway","readiness":{"ok":true}},"traceId":"b0b2910c1cc784d261975b9ba1ee87b9","spanId":"f3bf3573c57b842e"}
{"timestamp":"2025-11-27T17:17:30.977Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b0b2910c1cc784d261975b9ba1ee87b9","spanId":"f3bf3573c57b842e"}
{"timestamp":"2025-11-27T17:17:30.977Z","level":"info","message":"calling startRound","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway","roundIndex":0},"traceId":"b0b2910c1cc784d261975b9ba1ee87b9","spanId":"f3bf3573c57b842e"}
{"timestamp":"2025-11-27T17:17:30.979Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"b0b2910c1cc784d261975b9ba1ee87b9","spanId":"f3bf3573c57b842e"}
{"timestamp":"2025-11-27T17:17:30.979Z","level":"info","message":"startRound success, state committed","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b0b2910c1cc784d261975b9ba1ee87b9","spanId":"f3bf3573c57b842e"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'b0b2910c1cc784d261975b9ba1ee87b9',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'f3bf3573c57b842e',
  kind: 0,
  timestamp: 1764263850976000,
  duration: 3793.5,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'START_GAME'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:30.981Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"3792cbf5913be8297dea35b62126799b","spanId":"7f42df7eb2690ad9"}
{"timestamp":"2025-11-27T17:17:30.981Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"3792cbf5913be8297dea35b62126799b","spanId":"7f42df7eb2690ad9"}
{"timestamp":"2025-11-27T17:17:30.981Z","level":"info","message":"bid placed","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":0,"context":{"component":"event-log","bid":4},"traceId":"3792cbf5913be8297dea35b62126799b","spanId":"7f42df7eb2690ad9"}
{"timestamp":"2025-11-27T17:17:30.999Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"3792cbf5913be8297dea35b62126799b","spanId":"7f42df7eb2690ad9","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,0,PLAYER_BID,{\"playerId\":\"player_29792039a4cd005a\",\"bid\":4}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,0,PLAYER_BID,{\"playerId\":\"player_29792039a4cd005a\",\"bid\":4}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performBid (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:510:5)\n    at async WebSocketGateway.handleBid (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:307:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:252:13)"}}
{"timestamp":"2025-11-27T17:17:31.007Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"3792cbf5913be8297dea35b62126799b","spanId":"7f42df7eb2690ad9"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '3792cbf5913be8297dea35b62126799b',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '7f42df7eb2690ad9',
  kind: 0,
  timestamp: 1764263850981000,
  duration: 27027.667,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'BID'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.009Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"cec4c7840e99dbfd6f825d5fb53703a8","spanId":"322a2add3ec4365b"}
{"timestamp":"2025-11-27T17:17:31.009Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"cec4c7840e99dbfd6f825d5fb53703a8","spanId":"322a2add3ec4365b"}
{"timestamp":"2025-11-27T17:17:31.009Z","level":"info","message":"bid placed","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":1,"context":{"component":"event-log","bid":3},"traceId":"cec4c7840e99dbfd6f825d5fb53703a8","spanId":"322a2add3ec4365b"}
{"timestamp":"2025-11-27T17:17:31.023Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"cec4c7840e99dbfd6f825d5fb53703a8","spanId":"322a2add3ec4365b","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,1,PLAYER_BID,{\"playerId\":\"player_1478b88caf17a670\",\"bid\":3}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,1,PLAYER_BID,{\"playerId\":\"player_1478b88caf17a670\",\"bid\":3}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performBid (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:510:5)\n    at async WebSocketGateway.handleBid (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:307:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:252:13)"}}
{"timestamp":"2025-11-27T17:17:31.024Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"cec4c7840e99dbfd6f825d5fb53703a8","spanId":"322a2add3ec4365b"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'cec4c7840e99dbfd6f825d5fb53703a8',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '322a2add3ec4365b',
  kind: 0,
  timestamp: 1764263851009000,
  duration: 15950.709,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'BID'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.026Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"463cf6378cbbebf5d457343d670d2a7f","spanId":"6ddba76e3015b7d1"}
{"timestamp":"2025-11-27T17:17:31.026Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"463cf6378cbbebf5d457343d670d2a7f","spanId":"6ddba76e3015b7d1"}
{"timestamp":"2025-11-27T17:17:31.026Z","level":"info","message":"bid placed","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":2,"context":{"component":"event-log","bid":6},"traceId":"463cf6378cbbebf5d457343d670d2a7f","spanId":"6ddba76e3015b7d1"}
{"timestamp":"2025-11-27T17:17:31.036Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"463cf6378cbbebf5d457343d670d2a7f","spanId":"6ddba76e3015b7d1","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,2,PLAYER_BID,{\"playerId\":\"player_ddacdca0ffe1825e\",\"bid\":6}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,2,PLAYER_BID,{\"playerId\":\"player_ddacdca0ffe1825e\",\"bid\":6}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performBid (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:510:5)\n    at async WebSocketGateway.handleBid (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:307:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:252:13)"}}
{"timestamp":"2025-11-27T17:17:31.037Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"463cf6378cbbebf5d457343d670d2a7f","spanId":"6ddba76e3015b7d1"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '463cf6378cbbebf5d457343d670d2a7f',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '6ddba76e3015b7d1',
  kind: 0,
  timestamp: 1764263851026000,
  duration: 11126.458,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'BID'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.038Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"952229332fc5a2783970c9075ca11894","spanId":"8a788a7286b636d7"}
{"timestamp":"2025-11-27T17:17:31.038Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"952229332fc5a2783970c9075ca11894","spanId":"8a788a7286b636d7"}
{"timestamp":"2025-11-27T17:17:31.038Z","level":"info","message":"bid placed","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":3,"context":{"component":"event-log","bid":3},"traceId":"952229332fc5a2783970c9075ca11894","spanId":"8a788a7286b636d7"}
{"timestamp":"2025-11-27T17:17:31.053Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"952229332fc5a2783970c9075ca11894","spanId":"8a788a7286b636d7","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,3,PLAYER_BID,{\"playerId\":\"player_f8dbf1152d098b13\",\"bid\":3},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,4,BIDDING_COMPLETE,{}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,3,PLAYER_BID,{\"playerId\":\"player_f8dbf1152d098b13\",\"bid\":3},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,4,BIDDING_COMPLETE,{}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performBid (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:510:5)\n    at async WebSocketGateway.handleBid (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:307:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:252:13)"}}
{"timestamp":"2025-11-27T17:17:31.054Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"952229332fc5a2783970c9075ca11894","spanId":"8a788a7286b636d7"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '952229332fc5a2783970c9075ca11894',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '8a788a7286b636d7',
  kind: 0,
  timestamp: 1764263851038000,
  duration: 15655.709,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'BID'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.056Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"eaa229704cd8e3e044ca9358d4c20866","spanId":"0498fcc25634621c"}
{"timestamp":"2025-11-27T17:17:31.056Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"eaa229704cd8e3e044ca9358d4c20866","spanId":"0498fcc25634621c"}
{"timestamp":"2025-11-27T17:17:31.057Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":6,"context":{"component":"event-log","cardId":"d0:hearts:K"},"traceId":"eaa229704cd8e3e044ca9358d4c20866","spanId":"0498fcc25634621c"}
{"timestamp":"2025-11-27T17:17:31.071Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"eaa229704cd8e3e044ca9358d4c20866","spanId":"0498fcc25634621c","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,5,TRICK_STARTED,{\"trickIndex\":0,\"leaderPlayerId\":\"player_29792039a4cd005a\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,6,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:K\",\"suit\":\"hearts\",\"rank\":\"K\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,5,TRICK_STARTED,{\"trickIndex\":0,\"leaderPlayerId\":\"player_29792039a4cd005a\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,6,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:K\",\"suit\":\"hearts\",\"rank\":\"K\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.071Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"eaa229704cd8e3e044ca9358d4c20866","spanId":"0498fcc25634621c"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'eaa229704cd8e3e044ca9358d4c20866',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '0498fcc25634621c',
  kind: 0,
  timestamp: 1764263851056000,
  duration: 15944.083,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.073Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"41c89b857793855537e11803a9879fd3","spanId":"1fbaff1f9cbef4af"}
{"timestamp":"2025-11-27T17:17:31.073Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"41c89b857793855537e11803a9879fd3","spanId":"1fbaff1f9cbef4af"}
{"timestamp":"2025-11-27T17:17:31.073Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":7,"context":{"component":"event-log","cardId":"d0:hearts:J"},"traceId":"41c89b857793855537e11803a9879fd3","spanId":"1fbaff1f9cbef4af"}
{"timestamp":"2025-11-27T17:17:31.090Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"41c89b857793855537e11803a9879fd3","spanId":"1fbaff1f9cbef4af","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,7,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:hearts:J\",\"suit\":\"hearts\",\"rank\":\"J\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,7,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:hearts:J\",\"suit\":\"hearts\",\"rank\":\"J\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.091Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"41c89b857793855537e11803a9879fd3","spanId":"1fbaff1f9cbef4af"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '41c89b857793855537e11803a9879fd3',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '1fbaff1f9cbef4af',
  kind: 0,
  timestamp: 1764263851073000,
  duration: 18017.167,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.092Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e222c78c72695e539bc85417c46a4a5b","spanId":"9db3b607b981231b"}
{"timestamp":"2025-11-27T17:17:31.092Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e222c78c72695e539bc85417c46a4a5b","spanId":"9db3b607b981231b"}
{"timestamp":"2025-11-27T17:17:31.092Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":8,"context":{"component":"event-log","cardId":"d0:hearts:A"},"traceId":"e222c78c72695e539bc85417c46a4a5b","spanId":"9db3b607b981231b"}
{"timestamp":"2025-11-27T17:17:31.103Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e222c78c72695e539bc85417c46a4a5b","spanId":"9db3b607b981231b","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,8,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:hearts:A\",\"suit\":\"hearts\",\"rank\":\"A\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,8,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:hearts:A\",\"suit\":\"hearts\",\"rank\":\"A\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.103Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"e222c78c72695e539bc85417c46a4a5b","spanId":"9db3b607b981231b"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'e222c78c72695e539bc85417c46a4a5b',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '9db3b607b981231b',
  kind: 0,
  timestamp: 1764263851092000,
  duration: 11624.875,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.105Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"583df945b505a24b28e6038bdf135c85","spanId":"3272a2dbc8aac07d"}
{"timestamp":"2025-11-27T17:17:31.105Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"583df945b505a24b28e6038bdf135c85","spanId":"3272a2dbc8aac07d"}
{"timestamp":"2025-11-27T17:17:31.106Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":9,"context":{"component":"event-log","cardId":"d0:hearts:5"},"traceId":"583df945b505a24b28e6038bdf135c85","spanId":"3272a2dbc8aac07d"}
{"timestamp":"2025-11-27T17:17:31.128Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"583df945b505a24b28e6038bdf135c85","spanId":"3272a2dbc8aac07d","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,9,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:hearts:5\",\"suit\":\"hearts\",\"rank\":\"5\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,10,TRICK_COMPLETED,{\"trickIndex\":0,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:hearts:A\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,9,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:hearts:5\",\"suit\":\"hearts\",\"rank\":\"5\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,10,TRICK_COMPLETED,{\"trickIndex\":0,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:hearts:A\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.128Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"583df945b505a24b28e6038bdf135c85","spanId":"3272a2dbc8aac07d"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '583df945b505a24b28e6038bdf135c85',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '3272a2dbc8aac07d',
  kind: 0,
  timestamp: 1764263851105000,
  duration: 23520.959,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.130Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7cd666dc93a5920f09d391cd7a7021c0","spanId":"fa06e21be886cf9b"}
{"timestamp":"2025-11-27T17:17:31.130Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7cd666dc93a5920f09d391cd7a7021c0","spanId":"fa06e21be886cf9b"}
{"timestamp":"2025-11-27T17:17:31.130Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":12,"context":{"component":"event-log","cardId":"d0:diamonds:K"},"traceId":"7cd666dc93a5920f09d391cd7a7021c0","spanId":"fa06e21be886cf9b"}
{"timestamp":"2025-11-27T17:17:31.149Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7cd666dc93a5920f09d391cd7a7021c0","spanId":"fa06e21be886cf9b","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,11,TRICK_STARTED,{\"trickIndex\":1,\"leaderPlayerId\":\"player_ddacdca0ffe1825e\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,12,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:diamonds:K\",\"suit\":\"diamonds\",\"rank\":\"K\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,11,TRICK_STARTED,{\"trickIndex\":1,\"leaderPlayerId\":\"player_ddacdca0ffe1825e\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,12,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:diamonds:K\",\"suit\":\"diamonds\",\"rank\":\"K\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.150Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"7cd666dc93a5920f09d391cd7a7021c0","spanId":"fa06e21be886cf9b"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '7cd666dc93a5920f09d391cd7a7021c0',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'fa06e21be886cf9b',
  kind: 0,
  timestamp: 1764263851129000,
  duration: 20169.083,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.150Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"3ba0a49af27ef15e979f8ebc8e2a11d7","spanId":"104680c766bd6419"}
{"timestamp":"2025-11-27T17:17:31.150Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"3ba0a49af27ef15e979f8ebc8e2a11d7","spanId":"104680c766bd6419"}
{"timestamp":"2025-11-27T17:17:31.150Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":13,"context":{"component":"event-log","cardId":"d0:diamonds:A"},"traceId":"3ba0a49af27ef15e979f8ebc8e2a11d7","spanId":"104680c766bd6419"}
{"timestamp":"2025-11-27T17:17:31.163Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"3ba0a49af27ef15e979f8ebc8e2a11d7","spanId":"104680c766bd6419","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,13,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:diamonds:A\",\"suit\":\"diamonds\",\"rank\":\"A\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,13,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:diamonds:A\",\"suit\":\"diamonds\",\"rank\":\"A\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.164Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"3ba0a49af27ef15e979f8ebc8e2a11d7","spanId":"104680c766bd6419"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '3ba0a49af27ef15e979f8ebc8e2a11d7',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '104680c766bd6419',
  kind: 0,
  timestamp: 1764263851150000,
  duration: 13536.125,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.166Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"14870aa234f9c88e80c6e9414930dffa","spanId":"22c5d67667610597"}
{"timestamp":"2025-11-27T17:17:31.166Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"14870aa234f9c88e80c6e9414930dffa","spanId":"22c5d67667610597"}
{"timestamp":"2025-11-27T17:17:31.166Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":14,"context":{"component":"event-log","cardId":"d0:diamonds:9"},"traceId":"14870aa234f9c88e80c6e9414930dffa","spanId":"22c5d67667610597"}
{"timestamp":"2025-11-27T17:17:31.180Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"14870aa234f9c88e80c6e9414930dffa","spanId":"22c5d67667610597","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,14,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:diamonds:9\",\"suit\":\"diamonds\",\"rank\":\"9\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,14,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:diamonds:9\",\"suit\":\"diamonds\",\"rank\":\"9\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.180Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"14870aa234f9c88e80c6e9414930dffa","spanId":"22c5d67667610597"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '14870aa234f9c88e80c6e9414930dffa',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '22c5d67667610597',
  kind: 0,
  timestamp: 1764263851166000,
  duration: 14370.416,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.181Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"27f64a5c760ecb59d8746913ae874801","spanId":"f4d7427afd6ecc81"}
{"timestamp":"2025-11-27T17:17:31.181Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"27f64a5c760ecb59d8746913ae874801","spanId":"f4d7427afd6ecc81"}
{"timestamp":"2025-11-27T17:17:31.181Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":15,"context":{"component":"event-log","cardId":"d0:diamonds:J"},"traceId":"27f64a5c760ecb59d8746913ae874801","spanId":"f4d7427afd6ecc81"}
{"timestamp":"2025-11-27T17:17:31.202Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"27f64a5c760ecb59d8746913ae874801","spanId":"f4d7427afd6ecc81","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,15,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:diamonds:J\",\"suit\":\"diamonds\",\"rank\":\"J\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,16,TRICK_COMPLETED,{\"trickIndex\":1,\"winningPlayerId\":\"player_f8dbf1152d098b13\",\"winningCardId\":\"d0:diamonds:A\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,15,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:diamonds:J\",\"suit\":\"diamonds\",\"rank\":\"J\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,16,TRICK_COMPLETED,{\"trickIndex\":1,\"winningPlayerId\":\"player_f8dbf1152d098b13\",\"winningCardId\":\"d0:diamonds:A\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.203Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"27f64a5c760ecb59d8746913ae874801","spanId":"f4d7427afd6ecc81"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '27f64a5c760ecb59d8746913ae874801',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'f4d7427afd6ecc81',
  kind: 0,
  timestamp: 1764263851181000,
  duration: 21762.625,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.203Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"eacacfab65fcaf49956fe4341dd29dda","spanId":"14a09ec42be29523"}
{"timestamp":"2025-11-27T17:17:31.203Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"eacacfab65fcaf49956fe4341dd29dda","spanId":"14a09ec42be29523"}
{"timestamp":"2025-11-27T17:17:31.203Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":18,"context":{"component":"event-log","cardId":"d0:clubs:K"},"traceId":"eacacfab65fcaf49956fe4341dd29dda","spanId":"14a09ec42be29523"}
{"timestamp":"2025-11-27T17:17:31.213Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"eacacfab65fcaf49956fe4341dd29dda","spanId":"14a09ec42be29523","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,17,TRICK_STARTED,{\"trickIndex\":2,\"leaderPlayerId\":\"player_f8dbf1152d098b13\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,18,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:clubs:K\",\"suit\":\"clubs\",\"rank\":\"K\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,17,TRICK_STARTED,{\"trickIndex\":2,\"leaderPlayerId\":\"player_f8dbf1152d098b13\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,18,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:clubs:K\",\"suit\":\"clubs\",\"rank\":\"K\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.214Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"eacacfab65fcaf49956fe4341dd29dda","spanId":"14a09ec42be29523"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'eacacfab65fcaf49956fe4341dd29dda',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '14a09ec42be29523',
  kind: 0,
  timestamp: 1764263851203000,
  duration: 10922.75,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.216Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"807825c7248e30fa35d051225a5f0296","spanId":"ba32ae65d9f2d0fc"}
{"timestamp":"2025-11-27T17:17:31.216Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"807825c7248e30fa35d051225a5f0296","spanId":"ba32ae65d9f2d0fc"}
{"timestamp":"2025-11-27T17:17:31.217Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":19,"context":{"component":"event-log","cardId":"d0:clubs:4"},"traceId":"807825c7248e30fa35d051225a5f0296","spanId":"ba32ae65d9f2d0fc"}
{"timestamp":"2025-11-27T17:17:31.231Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"807825c7248e30fa35d051225a5f0296","spanId":"ba32ae65d9f2d0fc","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,19,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:clubs:4\",\"suit\":\"clubs\",\"rank\":\"4\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,19,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:clubs:4\",\"suit\":\"clubs\",\"rank\":\"4\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.232Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"807825c7248e30fa35d051225a5f0296","spanId":"ba32ae65d9f2d0fc"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '807825c7248e30fa35d051225a5f0296',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'ba32ae65d9f2d0fc',
  kind: 0,
  timestamp: 1764263851216000,
  duration: 17370.625,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.234Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e4d1333b2820b358580fd9294a74d074","spanId":"19a2a0ec60dd5846"}
{"timestamp":"2025-11-27T17:17:31.234Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e4d1333b2820b358580fd9294a74d074","spanId":"19a2a0ec60dd5846"}
{"timestamp":"2025-11-27T17:17:31.234Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":20,"context":{"component":"event-log","cardId":"d0:clubs:J"},"traceId":"e4d1333b2820b358580fd9294a74d074","spanId":"19a2a0ec60dd5846"}
{"timestamp":"2025-11-27T17:17:31.248Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e4d1333b2820b358580fd9294a74d074","spanId":"19a2a0ec60dd5846","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,20,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:clubs:J\",\"suit\":\"clubs\",\"rank\":\"J\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,20,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:clubs:J\",\"suit\":\"clubs\",\"rank\":\"J\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.249Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"e4d1333b2820b358580fd9294a74d074","spanId":"19a2a0ec60dd5846"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'e4d1333b2820b358580fd9294a74d074',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '19a2a0ec60dd5846',
  kind: 0,
  timestamp: 1764263851233000,
  duration: 15345.75,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.250Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"9ba44e555c04642904258b879a1c2584","spanId":"f8883bd58bf23472"}
{"timestamp":"2025-11-27T17:17:31.250Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"9ba44e555c04642904258b879a1c2584","spanId":"f8883bd58bf23472"}
{"timestamp":"2025-11-27T17:17:31.250Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":21,"context":{"component":"event-log","cardId":"d0:clubs:6"},"traceId":"9ba44e555c04642904258b879a1c2584","spanId":"f8883bd58bf23472"}
{"timestamp":"2025-11-27T17:17:31.264Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"9ba44e555c04642904258b879a1c2584","spanId":"f8883bd58bf23472","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,21,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:clubs:6\",\"suit\":\"clubs\",\"rank\":\"6\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,22,TRICK_COMPLETED,{\"trickIndex\":2,\"winningPlayerId\":\"player_f8dbf1152d098b13\",\"winningCardId\":\"d0:clubs:K\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,21,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:clubs:6\",\"suit\":\"clubs\",\"rank\":\"6\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,22,TRICK_COMPLETED,{\"trickIndex\":2,\"winningPlayerId\":\"player_f8dbf1152d098b13\",\"winningCardId\":\"d0:clubs:K\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.265Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"9ba44e555c04642904258b879a1c2584","spanId":"f8883bd58bf23472"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '9ba44e555c04642904258b879a1c2584',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'f8883bd58bf23472',
  kind: 0,
  timestamp: 1764263851250000,
  duration: 15251.917,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.266Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"fce6911c5180574c41a1fdd98982bb33","spanId":"79fd4fcf0b0053d1"}
{"timestamp":"2025-11-27T17:17:31.266Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"fce6911c5180574c41a1fdd98982bb33","spanId":"79fd4fcf0b0053d1"}
{"timestamp":"2025-11-27T17:17:31.266Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":24,"context":{"component":"event-log","cardId":"d0:clubs:10"},"traceId":"fce6911c5180574c41a1fdd98982bb33","spanId":"79fd4fcf0b0053d1"}
{"timestamp":"2025-11-27T17:17:31.279Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"fce6911c5180574c41a1fdd98982bb33","spanId":"79fd4fcf0b0053d1","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,23,TRICK_STARTED,{\"trickIndex\":3,\"leaderPlayerId\":\"player_f8dbf1152d098b13\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,24,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:clubs:10\",\"suit\":\"clubs\",\"rank\":\"10\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,23,TRICK_STARTED,{\"trickIndex\":3,\"leaderPlayerId\":\"player_f8dbf1152d098b13\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,24,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:clubs:10\",\"suit\":\"clubs\",\"rank\":\"10\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.280Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"fce6911c5180574c41a1fdd98982bb33","spanId":"79fd4fcf0b0053d1"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'fce6911c5180574c41a1fdd98982bb33',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '79fd4fcf0b0053d1',
  kind: 0,
  timestamp: 1764263851265000,
  duration: 14698.583,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.281Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b2e1340ad0b1b742356a72ae4ae8975e","spanId":"74deb779c35c167c"}
{"timestamp":"2025-11-27T17:17:31.281Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b2e1340ad0b1b742356a72ae4ae8975e","spanId":"74deb779c35c167c"}
{"timestamp":"2025-11-27T17:17:31.281Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":25,"context":{"component":"event-log","cardId":"d0:clubs:3"},"traceId":"b2e1340ad0b1b742356a72ae4ae8975e","spanId":"74deb779c35c167c"}
{"timestamp":"2025-11-27T17:17:31.303Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b2e1340ad0b1b742356a72ae4ae8975e","spanId":"74deb779c35c167c","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,25,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:clubs:3\",\"suit\":\"clubs\",\"rank\":\"3\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,25,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:clubs:3\",\"suit\":\"clubs\",\"rank\":\"3\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.304Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"b2e1340ad0b1b742356a72ae4ae8975e","spanId":"74deb779c35c167c"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'b2e1340ad0b1b742356a72ae4ae8975e',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '74deb779c35c167c',
  kind: 0,
  timestamp: 1764263851281000,
  duration: 23016.584,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.304Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"211496f90ca2748e53918efc4e876a23","spanId":"3732a0916aedcc2e"}
{"timestamp":"2025-11-27T17:17:31.304Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"211496f90ca2748e53918efc4e876a23","spanId":"3732a0916aedcc2e"}
{"timestamp":"2025-11-27T17:17:31.304Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":26,"context":{"component":"event-log","cardId":"d0:clubs:8"},"traceId":"211496f90ca2748e53918efc4e876a23","spanId":"3732a0916aedcc2e"}
{"timestamp":"2025-11-27T17:17:31.315Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"211496f90ca2748e53918efc4e876a23","spanId":"3732a0916aedcc2e","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,26,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:clubs:8\",\"suit\":\"clubs\",\"rank\":\"8\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,26,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:clubs:8\",\"suit\":\"clubs\",\"rank\":\"8\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.315Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"211496f90ca2748e53918efc4e876a23","spanId":"3732a0916aedcc2e"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '211496f90ca2748e53918efc4e876a23',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '3732a0916aedcc2e',
  kind: 0,
  timestamp: 1764263851304000,
  duration: 11188.541,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.316Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"00d5001e7a457fa0fbb4a902545369ab","spanId":"a566d370aaed3282"}
{"timestamp":"2025-11-27T17:17:31.317Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"00d5001e7a457fa0fbb4a902545369ab","spanId":"a566d370aaed3282"}
{"timestamp":"2025-11-27T17:17:31.317Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":27,"context":{"component":"event-log","cardId":"d0:clubs:5"},"traceId":"00d5001e7a457fa0fbb4a902545369ab","spanId":"a566d370aaed3282"}
{"timestamp":"2025-11-27T17:17:31.329Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"00d5001e7a457fa0fbb4a902545369ab","spanId":"a566d370aaed3282","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,27,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:clubs:5\",\"suit\":\"clubs\",\"rank\":\"5\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,28,TRICK_COMPLETED,{\"trickIndex\":3,\"winningPlayerId\":\"player_f8dbf1152d098b13\",\"winningCardId\":\"d0:clubs:10\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,27,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:clubs:5\",\"suit\":\"clubs\",\"rank\":\"5\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,28,TRICK_COMPLETED,{\"trickIndex\":3,\"winningPlayerId\":\"player_f8dbf1152d098b13\",\"winningCardId\":\"d0:clubs:10\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.330Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"00d5001e7a457fa0fbb4a902545369ab","spanId":"a566d370aaed3282"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '00d5001e7a457fa0fbb4a902545369ab',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'a566d370aaed3282',
  kind: 0,
  timestamp: 1764263851316000,
  duration: 13739.625,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.331Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"342ee67df00d8769ff4c6076013cc41c","spanId":"7a67fdab70e128bd"}
{"timestamp":"2025-11-27T17:17:31.331Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"342ee67df00d8769ff4c6076013cc41c","spanId":"7a67fdab70e128bd"}
{"timestamp":"2025-11-27T17:17:31.331Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":30,"context":{"component":"event-log","cardId":"d0:diamonds:10"},"traceId":"342ee67df00d8769ff4c6076013cc41c","spanId":"7a67fdab70e128bd"}
{"timestamp":"2025-11-27T17:17:31.341Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"342ee67df00d8769ff4c6076013cc41c","spanId":"7a67fdab70e128bd","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,29,TRICK_STARTED,{\"trickIndex\":4,\"leaderPlayerId\":\"player_f8dbf1152d098b13\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,30,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:diamonds:10\",\"suit\":\"diamonds\",\"rank\":\"10\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,29,TRICK_STARTED,{\"trickIndex\":4,\"leaderPlayerId\":\"player_f8dbf1152d098b13\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,30,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:diamonds:10\",\"suit\":\"diamonds\",\"rank\":\"10\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.341Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"342ee67df00d8769ff4c6076013cc41c","spanId":"7a67fdab70e128bd"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '342ee67df00d8769ff4c6076013cc41c',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '7a67fdab70e128bd',
  kind: 0,
  timestamp: 1764263851331000,
  duration: 10265.5,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.342Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e13d39b3876cd1c2d8c9317d1d843484","spanId":"bffb50838708fa73"}
{"timestamp":"2025-11-27T17:17:31.342Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e13d39b3876cd1c2d8c9317d1d843484","spanId":"bffb50838708fa73"}
{"timestamp":"2025-11-27T17:17:31.342Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":31,"context":{"component":"event-log","cardId":"d0:spades:6"},"traceId":"e13d39b3876cd1c2d8c9317d1d843484","spanId":"bffb50838708fa73"}
{"timestamp":"2025-11-27T17:17:31.353Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"e13d39b3876cd1c2d8c9317d1d843484","spanId":"bffb50838708fa73","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,31,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:spades:6\",\"suit\":\"spades\",\"rank\":\"6\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,32,TRUMP_BROKEN,{}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,31,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:spades:6\",\"suit\":\"spades\",\"rank\":\"6\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,32,TRUMP_BROKEN,{}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.354Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"e13d39b3876cd1c2d8c9317d1d843484","spanId":"bffb50838708fa73"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'e13d39b3876cd1c2d8c9317d1d843484',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'bffb50838708fa73',
  kind: 0,
  timestamp: 1764263851342000,
  duration: 11845.125,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.355Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"c98127d5fbf1ab92b36b7502cbc43b06","spanId":"d857a63afb08a67d"}
{"timestamp":"2025-11-27T17:17:31.355Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"c98127d5fbf1ab92b36b7502cbc43b06","spanId":"d857a63afb08a67d"}
{"timestamp":"2025-11-27T17:17:31.355Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":33,"context":{"component":"event-log","cardId":"d0:diamonds:5"},"traceId":"c98127d5fbf1ab92b36b7502cbc43b06","spanId":"d857a63afb08a67d"}
{"timestamp":"2025-11-27T17:17:31.364Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"c98127d5fbf1ab92b36b7502cbc43b06","spanId":"d857a63afb08a67d","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,33,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:diamonds:5\",\"suit\":\"diamonds\",\"rank\":\"5\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,33,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:diamonds:5\",\"suit\":\"diamonds\",\"rank\":\"5\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.364Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"c98127d5fbf1ab92b36b7502cbc43b06","spanId":"d857a63afb08a67d"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'c98127d5fbf1ab92b36b7502cbc43b06',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'd857a63afb08a67d',
  kind: 0,
  timestamp: 1764263851355000,
  duration: 9662.375,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.365Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"268c29ab9a2eaeab170dad57ac0dd242","spanId":"1a624cc5e979ec71"}
{"timestamp":"2025-11-27T17:17:31.365Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"268c29ab9a2eaeab170dad57ac0dd242","spanId":"1a624cc5e979ec71"}
{"timestamp":"2025-11-27T17:17:31.365Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":34,"context":{"component":"event-log","cardId":"d0:diamonds:8"},"traceId":"268c29ab9a2eaeab170dad57ac0dd242","spanId":"1a624cc5e979ec71"}
{"timestamp":"2025-11-27T17:17:31.375Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"268c29ab9a2eaeab170dad57ac0dd242","spanId":"1a624cc5e979ec71","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,34,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:diamonds:8\",\"suit\":\"diamonds\",\"rank\":\"8\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,35,TRICK_COMPLETED,{\"trickIndex\":4,\"winningPlayerId\":\"player_29792039a4cd005a\",\"winningCardId\":\"d0:spades:6\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,34,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:diamonds:8\",\"suit\":\"diamonds\",\"rank\":\"8\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,35,TRICK_COMPLETED,{\"trickIndex\":4,\"winningPlayerId\":\"player_29792039a4cd005a\",\"winningCardId\":\"d0:spades:6\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.375Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"268c29ab9a2eaeab170dad57ac0dd242","spanId":"1a624cc5e979ec71"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '268c29ab9a2eaeab170dad57ac0dd242',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '1a624cc5e979ec71',
  kind: 0,
  timestamp: 1764263851365000,
  duration: 10395.458,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.376Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"59dd1f1e3463fa7830b300bac81b8999","spanId":"876a947851f98af5"}
{"timestamp":"2025-11-27T17:17:31.376Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"59dd1f1e3463fa7830b300bac81b8999","spanId":"876a947851f98af5"}
{"timestamp":"2025-11-27T17:17:31.376Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":37,"context":{"component":"event-log","cardId":"d0:hearts:9"},"traceId":"59dd1f1e3463fa7830b300bac81b8999","spanId":"876a947851f98af5"}
{"timestamp":"2025-11-27T17:17:31.388Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"59dd1f1e3463fa7830b300bac81b8999","spanId":"876a947851f98af5","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,36,TRICK_STARTED,{\"trickIndex\":5,\"leaderPlayerId\":\"player_29792039a4cd005a\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,37,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:9\",\"suit\":\"hearts\",\"rank\":\"9\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,36,TRICK_STARTED,{\"trickIndex\":5,\"leaderPlayerId\":\"player_29792039a4cd005a\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,37,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:9\",\"suit\":\"hearts\",\"rank\":\"9\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.388Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"59dd1f1e3463fa7830b300bac81b8999","spanId":"876a947851f98af5"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '59dd1f1e3463fa7830b300bac81b8999',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '876a947851f98af5',
  kind: 0,
  timestamp: 1764263851376000,
  duration: 12736.916,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.389Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"db94afa418b2e75f4b9ee111a36c4de0","spanId":"657c773b6c9d1783"}
{"timestamp":"2025-11-27T17:17:31.389Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"db94afa418b2e75f4b9ee111a36c4de0","spanId":"657c773b6c9d1783"}
{"timestamp":"2025-11-27T17:17:31.389Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":38,"context":{"component":"event-log","cardId":"d0:hearts:10"},"traceId":"db94afa418b2e75f4b9ee111a36c4de0","spanId":"657c773b6c9d1783"}
{"timestamp":"2025-11-27T17:17:31.398Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"db94afa418b2e75f4b9ee111a36c4de0","spanId":"657c773b6c9d1783","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,38,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:hearts:10\",\"suit\":\"hearts\",\"rank\":\"10\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,38,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:hearts:10\",\"suit\":\"hearts\",\"rank\":\"10\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.398Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"db94afa418b2e75f4b9ee111a36c4de0","spanId":"657c773b6c9d1783"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'db94afa418b2e75f4b9ee111a36c4de0',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '657c773b6c9d1783',
  kind: 0,
  timestamp: 1764263851389000,
  duration: 9660.167,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.399Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"204016e16aa8fd629955cda783fa0ce0","spanId":"ab76df75fbbd7e3e"}
{"timestamp":"2025-11-27T17:17:31.399Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"204016e16aa8fd629955cda783fa0ce0","spanId":"ab76df75fbbd7e3e"}
{"timestamp":"2025-11-27T17:17:31.399Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":39,"context":{"component":"event-log","cardId":"d0:spades:3"},"traceId":"204016e16aa8fd629955cda783fa0ce0","spanId":"ab76df75fbbd7e3e"}
{"timestamp":"2025-11-27T17:17:31.408Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"204016e16aa8fd629955cda783fa0ce0","spanId":"ab76df75fbbd7e3e","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,39,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:spades:3\",\"suit\":\"spades\",\"rank\":\"3\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,39,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:spades:3\",\"suit\":\"spades\",\"rank\":\"3\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.410Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"204016e16aa8fd629955cda783fa0ce0","spanId":"ab76df75fbbd7e3e"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '204016e16aa8fd629955cda783fa0ce0',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'ab76df75fbbd7e3e',
  kind: 0,
  timestamp: 1764263851399000,
  duration: 11040.542,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.412Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"d061fa2572018ff442e687c18dc3397a","spanId":"9a894700581f3e82"}
{"timestamp":"2025-11-27T17:17:31.412Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"d061fa2572018ff442e687c18dc3397a","spanId":"9a894700581f3e82"}
{"timestamp":"2025-11-27T17:17:31.413Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":40,"context":{"component":"event-log","cardId":"d0:hearts:2"},"traceId":"d061fa2572018ff442e687c18dc3397a","spanId":"9a894700581f3e82"}
{"timestamp":"2025-11-27T17:17:31.424Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"d061fa2572018ff442e687c18dc3397a","spanId":"9a894700581f3e82","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,40,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:hearts:2\",\"suit\":\"hearts\",\"rank\":\"2\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,41,TRICK_COMPLETED,{\"trickIndex\":5,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:spades:3\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,40,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:hearts:2\",\"suit\":\"hearts\",\"rank\":\"2\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,41,TRICK_COMPLETED,{\"trickIndex\":5,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:spades:3\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.425Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"d061fa2572018ff442e687c18dc3397a","spanId":"9a894700581f3e82"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'd061fa2572018ff442e687c18dc3397a',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '9a894700581f3e82',
  kind: 0,
  timestamp: 1764263851412000,
  duration: 12468.792,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.425Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"5a6273ecb621b59d918bf0fbe1dcaf8c","spanId":"8ec4368322985843"}
{"timestamp":"2025-11-27T17:17:31.425Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"5a6273ecb621b59d918bf0fbe1dcaf8c","spanId":"8ec4368322985843"}
{"timestamp":"2025-11-27T17:17:31.425Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":43,"context":{"component":"event-log","cardId":"d0:spades:9"},"traceId":"5a6273ecb621b59d918bf0fbe1dcaf8c","spanId":"8ec4368322985843"}
{"timestamp":"2025-11-27T17:17:31.435Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"5a6273ecb621b59d918bf0fbe1dcaf8c","spanId":"8ec4368322985843","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,42,TRICK_STARTED,{\"trickIndex\":6,\"leaderPlayerId\":\"player_ddacdca0ffe1825e\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,43,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:spades:9\",\"suit\":\"spades\",\"rank\":\"9\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,42,TRICK_STARTED,{\"trickIndex\":6,\"leaderPlayerId\":\"player_ddacdca0ffe1825e\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,43,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:spades:9\",\"suit\":\"spades\",\"rank\":\"9\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.436Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"5a6273ecb621b59d918bf0fbe1dcaf8c","spanId":"8ec4368322985843"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '5a6273ecb621b59d918bf0fbe1dcaf8c',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '8ec4368322985843',
  kind: 0,
  timestamp: 1764263851425000,
  duration: 10359.917,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.436Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"2532e1fc5272539e215754ac9fdb15d9","spanId":"633c5226b8730a75"}
{"timestamp":"2025-11-27T17:17:31.436Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"2532e1fc5272539e215754ac9fdb15d9","spanId":"633c5226b8730a75"}
{"timestamp":"2025-11-27T17:17:31.436Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":44,"context":{"component":"event-log","cardId":"d0:spades:Q"},"traceId":"2532e1fc5272539e215754ac9fdb15d9","spanId":"633c5226b8730a75"}
{"timestamp":"2025-11-27T17:17:31.453Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"2532e1fc5272539e215754ac9fdb15d9","spanId":"633c5226b8730a75","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,44,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:spades:Q\",\"suit\":\"spades\",\"rank\":\"Q\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,44,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:spades:Q\",\"suit\":\"spades\",\"rank\":\"Q\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.453Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"2532e1fc5272539e215754ac9fdb15d9","spanId":"633c5226b8730a75"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '2532e1fc5272539e215754ac9fdb15d9',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '633c5226b8730a75',
  kind: 0,
  timestamp: 1764263851436000,
  duration: 17362.292,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.454Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"0c555c5087e6858c321bbd734eb64df6","spanId":"69c80fae4d964377"}
{"timestamp":"2025-11-27T17:17:31.454Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"0c555c5087e6858c321bbd734eb64df6","spanId":"69c80fae4d964377"}
{"timestamp":"2025-11-27T17:17:31.454Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":45,"context":{"component":"event-log","cardId":"d0:spades:J"},"traceId":"0c555c5087e6858c321bbd734eb64df6","spanId":"69c80fae4d964377"}
{"timestamp":"2025-11-27T17:17:31.462Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"0c555c5087e6858c321bbd734eb64df6","spanId":"69c80fae4d964377","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,45,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:spades:J\",\"suit\":\"spades\",\"rank\":\"J\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,45,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:spades:J\",\"suit\":\"spades\",\"rank\":\"J\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.463Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"0c555c5087e6858c321bbd734eb64df6","spanId":"69c80fae4d964377"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '0c555c5087e6858c321bbd734eb64df6',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '69c80fae4d964377',
  kind: 0,
  timestamp: 1764263851454000,
  duration: 9704.833,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.464Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"50d28a214851b7b9e11c51f3a8fd2003","spanId":"845f39f1c4723a1d"}
{"timestamp":"2025-11-27T17:17:31.464Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"50d28a214851b7b9e11c51f3a8fd2003","spanId":"845f39f1c4723a1d"}
{"timestamp":"2025-11-27T17:17:31.464Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":46,"context":{"component":"event-log","cardId":"d0:spades:K"},"traceId":"50d28a214851b7b9e11c51f3a8fd2003","spanId":"845f39f1c4723a1d"}
{"timestamp":"2025-11-27T17:17:31.473Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"50d28a214851b7b9e11c51f3a8fd2003","spanId":"845f39f1c4723a1d","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,46,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:spades:K\",\"suit\":\"spades\",\"rank\":\"K\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,47,TRICK_COMPLETED,{\"trickIndex\":6,\"winningPlayerId\":\"player_1478b88caf17a670\",\"winningCardId\":\"d0:spades:K\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,46,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:spades:K\",\"suit\":\"spades\",\"rank\":\"K\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,47,TRICK_COMPLETED,{\"trickIndex\":6,\"winningPlayerId\":\"player_1478b88caf17a670\",\"winningCardId\":\"d0:spades:K\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.474Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"50d28a214851b7b9e11c51f3a8fd2003","spanId":"845f39f1c4723a1d"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '50d28a214851b7b9e11c51f3a8fd2003',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '845f39f1c4723a1d',
  kind: 0,
  timestamp: 1764263851464000,
  duration: 10187.583,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.474Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"a271964c775bfd469239c28eff810035","spanId":"f2330977765e2059"}
{"timestamp":"2025-11-27T17:17:31.474Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"a271964c775bfd469239c28eff810035","spanId":"f2330977765e2059"}
{"timestamp":"2025-11-27T17:17:31.475Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":49,"context":{"component":"event-log","cardId":"d0:diamonds:3"},"traceId":"a271964c775bfd469239c28eff810035","spanId":"f2330977765e2059"}
{"timestamp":"2025-11-27T17:17:31.486Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"a271964c775bfd469239c28eff810035","spanId":"f2330977765e2059","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,48,TRICK_STARTED,{\"trickIndex\":7,\"leaderPlayerId\":\"player_1478b88caf17a670\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,49,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:diamonds:3\",\"suit\":\"diamonds\",\"rank\":\"3\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,48,TRICK_STARTED,{\"trickIndex\":7,\"leaderPlayerId\":\"player_1478b88caf17a670\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,49,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:diamonds:3\",\"suit\":\"diamonds\",\"rank\":\"3\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.487Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"a271964c775bfd469239c28eff810035","spanId":"f2330977765e2059"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'a271964c775bfd469239c28eff810035',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'f2330977765e2059',
  kind: 0,
  timestamp: 1764263851474000,
  duration: 12735.667,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.488Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"40d67ea396b18d71999f069f1d03cc24","spanId":"7ff7cc246e8ccddd"}
{"timestamp":"2025-11-27T17:17:31.488Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"40d67ea396b18d71999f069f1d03cc24","spanId":"7ff7cc246e8ccddd"}
{"timestamp":"2025-11-27T17:17:31.488Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":50,"context":{"component":"event-log","cardId":"d0:diamonds:7"},"traceId":"40d67ea396b18d71999f069f1d03cc24","spanId":"7ff7cc246e8ccddd"}
{"timestamp":"2025-11-27T17:17:31.498Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"40d67ea396b18d71999f069f1d03cc24","spanId":"7ff7cc246e8ccddd","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,50,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:diamonds:7\",\"suit\":\"diamonds\",\"rank\":\"7\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,50,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:diamonds:7\",\"suit\":\"diamonds\",\"rank\":\"7\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.499Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"40d67ea396b18d71999f069f1d03cc24","spanId":"7ff7cc246e8ccddd"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '40d67ea396b18d71999f069f1d03cc24',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '7ff7cc246e8ccddd',
  kind: 0,
  timestamp: 1764263851488000,
  duration: 10894.541,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.499Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7318db00831beef242987d65bd2468f9","spanId":"7a4893fd89037ddc"}
{"timestamp":"2025-11-27T17:17:31.499Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7318db00831beef242987d65bd2468f9","spanId":"7a4893fd89037ddc"}
{"timestamp":"2025-11-27T17:17:31.499Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":51,"context":{"component":"event-log","cardId":"d0:diamonds:4"},"traceId":"7318db00831beef242987d65bd2468f9","spanId":"7a4893fd89037ddc"}
{"timestamp":"2025-11-27T17:17:31.519Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7318db00831beef242987d65bd2468f9","spanId":"7a4893fd89037ddc","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,51,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:diamonds:4\",\"suit\":\"diamonds\",\"rank\":\"4\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,51,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:diamonds:4\",\"suit\":\"diamonds\",\"rank\":\"4\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.520Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"7318db00831beef242987d65bd2468f9","spanId":"7a4893fd89037ddc"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '7318db00831beef242987d65bd2468f9',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '7a4893fd89037ddc',
  kind: 0,
  timestamp: 1764263851499000,
  duration: 20758.5,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.520Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b408d9bdc8778ae82aaafcad0451ffcd","spanId":"62ee573a080773af"}
{"timestamp":"2025-11-27T17:17:31.520Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b408d9bdc8778ae82aaafcad0451ffcd","spanId":"62ee573a080773af"}
{"timestamp":"2025-11-27T17:17:31.520Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":52,"context":{"component":"event-log","cardId":"d0:hearts:8"},"traceId":"b408d9bdc8778ae82aaafcad0451ffcd","spanId":"62ee573a080773af"}
{"timestamp":"2025-11-27T17:17:31.530Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"b408d9bdc8778ae82aaafcad0451ffcd","spanId":"62ee573a080773af","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,52,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:8\",\"suit\":\"hearts\",\"rank\":\"8\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,53,TRICK_COMPLETED,{\"trickIndex\":7,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:diamonds:7\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,52,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:8\",\"suit\":\"hearts\",\"rank\":\"8\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,53,TRICK_COMPLETED,{\"trickIndex\":7,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:diamonds:7\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.530Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"b408d9bdc8778ae82aaafcad0451ffcd","spanId":"62ee573a080773af"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'b408d9bdc8778ae82aaafcad0451ffcd',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '62ee573a080773af',
  kind: 0,
  timestamp: 1764263851520000,
  duration: 10458.542,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.531Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"6234f89bd330f497b0c4ccb10d815058","spanId":"d50485f7fab5c257"}
{"timestamp":"2025-11-27T17:17:31.531Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"6234f89bd330f497b0c4ccb10d815058","spanId":"d50485f7fab5c257"}
{"timestamp":"2025-11-27T17:17:31.531Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":55,"context":{"component":"event-log","cardId":"d0:spades:7"},"traceId":"6234f89bd330f497b0c4ccb10d815058","spanId":"d50485f7fab5c257"}
{"timestamp":"2025-11-27T17:17:31.542Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"6234f89bd330f497b0c4ccb10d815058","spanId":"d50485f7fab5c257","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,54,TRICK_STARTED,{\"trickIndex\":8,\"leaderPlayerId\":\"player_ddacdca0ffe1825e\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,55,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:spades:7\",\"suit\":\"spades\",\"rank\":\"7\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,54,TRICK_STARTED,{\"trickIndex\":8,\"leaderPlayerId\":\"player_ddacdca0ffe1825e\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,55,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:spades:7\",\"suit\":\"spades\",\"rank\":\"7\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.543Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"6234f89bd330f497b0c4ccb10d815058","spanId":"d50485f7fab5c257"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '6234f89bd330f497b0c4ccb10d815058',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'd50485f7fab5c257',
  kind: 0,
  timestamp: 1764263851531000,
  duration: 11966.417,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.544Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"f0f5fdb94ede9b92e1976ebf312c5b3c","spanId":"5b4a01cc777d8a43"}
{"timestamp":"2025-11-27T17:17:31.544Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"f0f5fdb94ede9b92e1976ebf312c5b3c","spanId":"5b4a01cc777d8a43"}
{"timestamp":"2025-11-27T17:17:31.544Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":56,"context":{"component":"event-log","cardId":"d0:clubs:9"},"traceId":"f0f5fdb94ede9b92e1976ebf312c5b3c","spanId":"5b4a01cc777d8a43"}
{"timestamp":"2025-11-27T17:17:31.553Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"f0f5fdb94ede9b92e1976ebf312c5b3c","spanId":"5b4a01cc777d8a43","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,56,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:clubs:9\",\"suit\":\"clubs\",\"rank\":\"9\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,56,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:clubs:9\",\"suit\":\"clubs\",\"rank\":\"9\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.553Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"f0f5fdb94ede9b92e1976ebf312c5b3c","spanId":"5b4a01cc777d8a43"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'f0f5fdb94ede9b92e1976ebf312c5b3c',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '5b4a01cc777d8a43',
  kind: 0,
  timestamp: 1764263851543000,
  duration: 9859.625,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.554Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"89f03d3c364f22ce587de1cfc363495a","spanId":"cf608c3fd8e5144d"}
{"timestamp":"2025-11-27T17:17:31.554Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"89f03d3c364f22ce587de1cfc363495a","spanId":"cf608c3fd8e5144d"}
{"timestamp":"2025-11-27T17:17:31.554Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":57,"context":{"component":"event-log","cardId":"d0:hearts:4"},"traceId":"89f03d3c364f22ce587de1cfc363495a","spanId":"cf608c3fd8e5144d"}
{"timestamp":"2025-11-27T17:17:31.565Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"89f03d3c364f22ce587de1cfc363495a","spanId":"cf608c3fd8e5144d","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,57,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:4\",\"suit\":\"hearts\",\"rank\":\"4\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,57,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:4\",\"suit\":\"hearts\",\"rank\":\"4\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.567Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"89f03d3c364f22ce587de1cfc363495a","spanId":"cf608c3fd8e5144d"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '89f03d3c364f22ce587de1cfc363495a',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'cf608c3fd8e5144d',
  kind: 0,
  timestamp: 1764263851554000,
  duration: 13413.5,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.569Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"fcfd19f3b38fd3bb28ab9ccf45a6bdbd","spanId":"97f25a1992903b8c"}
{"timestamp":"2025-11-27T17:17:31.569Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"fcfd19f3b38fd3bb28ab9ccf45a6bdbd","spanId":"97f25a1992903b8c"}
{"timestamp":"2025-11-27T17:17:31.569Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":58,"context":{"component":"event-log","cardId":"d0:spades:2"},"traceId":"fcfd19f3b38fd3bb28ab9ccf45a6bdbd","spanId":"97f25a1992903b8c"}
{"timestamp":"2025-11-27T17:17:31.581Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"fcfd19f3b38fd3bb28ab9ccf45a6bdbd","spanId":"97f25a1992903b8c","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,58,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:spades:2\",\"suit\":\"spades\",\"rank\":\"2\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,59,TRICK_COMPLETED,{\"trickIndex\":8,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:spades:7\"}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,58,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:spades:2\",\"suit\":\"spades\",\"rank\":\"2\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,59,TRICK_COMPLETED,{\"trickIndex\":8,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:spades:7\"}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.582Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"fcfd19f3b38fd3bb28ab9ccf45a6bdbd","spanId":"97f25a1992903b8c"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: 'fcfd19f3b38fd3bb28ab9ccf45a6bdbd',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '97f25a1992903b8c',
  kind: 0,
  timestamp: 1764263851569000,
  duration: 13476.125,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.583Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"30a473a52f6c1c65524a3c9bdbfc6b4d","spanId":"cf0d37442d4a914f"}
{"timestamp":"2025-11-27T17:17:31.583Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"30a473a52f6c1c65524a3c9bdbfc6b4d","spanId":"cf0d37442d4a914f"}
{"timestamp":"2025-11-27T17:17:31.583Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":61,"context":{"component":"event-log","cardId":"d0:spades:5"},"traceId":"30a473a52f6c1c65524a3c9bdbfc6b4d","spanId":"cf0d37442d4a914f"}
{"timestamp":"2025-11-27T17:17:31.592Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"30a473a52f6c1c65524a3c9bdbfc6b4d","spanId":"cf0d37442d4a914f","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,60,TRICK_STARTED,{\"trickIndex\":9,\"leaderPlayerId\":\"player_ddacdca0ffe1825e\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,61,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:spades:5\",\"suit\":\"spades\",\"rank\":\"5\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,60,TRICK_STARTED,{\"trickIndex\":9,\"leaderPlayerId\":\"player_ddacdca0ffe1825e\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,61,CARD_PLAYED,{\"playerId\":\"player_ddacdca0ffe1825e\",\"card\":{\"id\":\"d0:spades:5\",\"suit\":\"spades\",\"rank\":\"5\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.592Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"30a473a52f6c1c65524a3c9bdbfc6b4d","spanId":"cf0d37442d4a914f"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '30a473a52f6c1c65524a3c9bdbfc6b4d',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'cf0d37442d4a914f',
  kind: 0,
  timestamp: 1764263851583000,
  duration: 9663.542,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_ddacdca0ffe1825e',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.593Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"4facc0c6a07c1b96a45cca97b7cf4167","spanId":"0816390324a28dee"}
{"timestamp":"2025-11-27T17:17:31.593Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"4facc0c6a07c1b96a45cca97b7cf4167","spanId":"0816390324a28dee"}
{"timestamp":"2025-11-27T17:17:31.593Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":62,"context":{"component":"event-log","cardId":"d0:clubs:7"},"traceId":"4facc0c6a07c1b96a45cca97b7cf4167","spanId":"0816390324a28dee"}
{"timestamp":"2025-11-27T17:17:31.601Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"4facc0c6a07c1b96a45cca97b7cf4167","spanId":"0816390324a28dee","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,62,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:clubs:7\",\"suit\":\"clubs\",\"rank\":\"7\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,62,CARD_PLAYED,{\"playerId\":\"player_f8dbf1152d098b13\",\"card\":{\"id\":\"d0:clubs:7\",\"suit\":\"clubs\",\"rank\":\"7\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.602Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"4facc0c6a07c1b96a45cca97b7cf4167","spanId":"0816390324a28dee"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '4facc0c6a07c1b96a45cca97b7cf4167',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '0816390324a28dee',
  kind: 0,
  timestamp: 1764263851593000,
  duration: 9104.125,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_f8dbf1152d098b13',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.603Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7d1053cace1fdf2c953d9e4c8d96d1ad","spanId":"bd5e9b5d250c505f"}
{"timestamp":"2025-11-27T17:17:31.603Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7d1053cace1fdf2c953d9e4c8d96d1ad","spanId":"bd5e9b5d250c505f"}
{"timestamp":"2025-11-27T17:17:31.603Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":63,"context":{"component":"event-log","cardId":"d0:hearts:3"},"traceId":"7d1053cace1fdf2c953d9e4c8d96d1ad","spanId":"bd5e9b5d250c505f"}
{"timestamp":"2025-11-27T17:17:31.616Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"7d1053cace1fdf2c953d9e4c8d96d1ad","spanId":"bd5e9b5d250c505f","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,63,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:3\",\"suit\":\"hearts\",\"rank\":\"3\",\"deckIndex\":0}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,63,CARD_PLAYED,{\"playerId\":\"player_29792039a4cd005a\",\"card\":{\"id\":\"d0:hearts:3\",\"suit\":\"hearts\",\"rank\":\"3\",\"deckIndex\":0}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.617Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"7d1053cace1fdf2c953d9e4c8d96d1ad","spanId":"bd5e9b5d250c505f"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '7d1053cace1fdf2c953d9e4c8d96d1ad',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: 'bd5e9b5d250c505f',
  kind: 0,
  timestamp: 1764263851603000,
  duration: 13973.292,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_29792039a4cd005a',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:31.617Z","level":"info","message":"ensureRound called","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"27af0493ffcb536a178e679f3683a1bd","spanId":"03570a376d10f7c7"}
{"timestamp":"2025-11-27T17:17:31.617Z","level":"info","message":"ensureRound: round already exists","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"27af0493ffcb536a178e679f3683a1bd","spanId":"03570a376d10f7c7"}
{"timestamp":"2025-11-27T17:17:31.618Z","level":"info","message":"card played","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":64,"context":{"component":"event-log","cardId":"d0:diamonds:2"},"traceId":"27af0493ffcb536a178e679f3683a1bd","spanId":"03570a376d10f7c7"}
{"timestamp":"2025-11-27T17:17:31.618Z","level":"info","message":"round scored","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":66,"context":{"component":"event-log","deltas":{"player_f8dbf1152d098b13":8,"player_29792039a4cd005a":-9,"player_1478b88caf17a670":-8,"player_ddacdca0ffe1825e":-11},"cumulativeScores":{"player_f8dbf1152d098b13":8,"player_29792039a4cd005a":-9,"player_1478b88caf17a670":-8,"player_ddacdca0ffe1825e":-11}},"traceId":"27af0493ffcb536a178e679f3683a1bd","spanId":"03570a376d10f7c7"}
{"timestamp":"2025-11-27T17:17:31.618Z","level":"info","message":"game completed","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":67,"context":{"component":"event-log","finalScores":{"player_f8dbf1152d098b13":8,"player_29792039a4cd005a":-9,"player_1478b88caf17a670":-8,"player_ddacdca0ffe1825e":-11}},"traceId":"27af0493ffcb536a178e679f3683a1bd","spanId":"03570a376d10f7c7"}
{"timestamp":"2025-11-27T17:17:31.630Z","level":"error","message":"failed to persist events","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":null,"eventIndex":null,"context":{"component":"ws-gateway"},"traceId":"27af0493ffcb536a178e679f3683a1bd","spanId":"03570a376d10f7c7","error":{"name":"Error","message":"Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default), (default, $9, $10, $11, $12, default), (default, $13, $14, $15, $16, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,64,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:diamonds:2\",\"suit\":\"diamonds\",\"rank\":\"2\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,65,TRICK_COMPLETED,{\"trickIndex\":9,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:spades:5\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,66,ROUND_SCORED,{\"deltas\":{\"player_f8dbf1152d098b13\":8,\"player_29792039a4cd005a\":-9,\"player_1478b88caf17a670\":-8,\"player_ddacdca0ffe1825e\":-11},\"cumulativeScores\":{\"player_f8dbf1152d098b13\":8,\"player_29792039a4cd005a\":-9,\"player_1478b88caf17a670\":-8,\"player_ddacdca0ffe1825e\":-11}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,67,GAME_COMPLETED,{\"finalScores\":{\"player_f8dbf1152d098b13\":8,\"player_29792039a4cd005a\":-9,\"player_1478b88caf17a670\":-8,\"player_ddacdca0ffe1825e\":-11}}","stack":"Error: Failed query: insert into \"game_events\" (\"id\", \"game_id\", \"event_index\", \"type\", \"payload\", \"created_at\") values (default, $1, $2, $3, $4, default), (default, $5, $6, $7, $8, default), (default, $9, $10, $11, $12, default), (default, $13, $14, $15, $16, default)\nparams: 44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,64,CARD_PLAYED,{\"playerId\":\"player_1478b88caf17a670\",\"card\":{\"id\":\"d0:diamonds:2\",\"suit\":\"diamonds\",\"rank\":\"2\",\"deckIndex\":0}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,65,TRICK_COMPLETED,{\"trickIndex\":9,\"winningPlayerId\":\"player_ddacdca0ffe1825e\",\"winningCardId\":\"d0:spades:5\"},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,66,ROUND_SCORED,{\"deltas\":{\"player_f8dbf1152d098b13\":8,\"player_29792039a4cd005a\":-9,\"player_1478b88caf17a670\":-8,\"player_ddacdca0ffe1825e\":-11},\"cumulativeScores\":{\"player_f8dbf1152d098b13\":8,\"player_29792039a4cd005a\":-9,\"player_1478b88caf17a670\":-8,\"player_ddacdca0ffe1825e\":-11}},44dc65c2-5fda-4b06-8d7b-7dbcacc644cc,67,GAME_COMPLETED,{\"finalScores\":{\"player_f8dbf1152d098b13\":8,\"player_29792039a4cd005a\":-9,\"player_1478b88caf17a670\":-8,\"player_ddacdca0ffe1825e\":-11}}\n    at NodePgPreparedQuery.queryWithCache (/Users/mbp/Development/el-dorado-tanstack/node_modules/.pnpm/drizzle-orm@0.44.7_@opentelemetry+api@1.9.0_@types+pg@8.15.6_@upstash+redis@1.35.6_pg@8.16.3/node_modules/src/pg-core/session.ts:73:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async GamePersistence.appendEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/persistence/GamePersistence.ts:99:5)\n    at async WebSocketGateway.persistEvents (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:757:7)\n    at async WebSocketGateway.performPlay (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:553:5)\n    at async WebSocketGateway.handlePlayCard (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:300:5)\n    at async <anonymous> (/Users/mbp/Development/el-dorado-tanstack/apps/server/src/ws/Gateway.ts:249:13)"}}
{"timestamp":"2025-11-27T17:17:31.630Z","level":"info","message":"No bots found, skipping...","gameId":null,"playerId":null,"eventIndex":null,"context":{},"traceId":"27af0493ffcb536a178e679f3683a1bd","spanId":"03570a376d10f7c7"}
{
  resource: {
    attributes: {
      'service.name': 'el-dorado-server',
      'service.version': '0.0.0',
      'telemetry.sdk.language': 'nodejs',
      'telemetry.sdk.name': 'opentelemetry',
      'telemetry.sdk.version': '2.2.0'
    }
  },
  instrumentationScope: {
    name: 'el-dorado-server',
    version: undefined,
    schemaUrl: undefined
  },
  traceId: '27af0493ffcb536a178e679f3683a1bd',
  parentSpanContext: undefined,
  traceState: undefined,
  name: 'ws.message',
  id: '03570a376d10f7c7',
  kind: 0,
  timestamp: 1764263851617000,
  duration: 13280.541,
  attributes: {
    'game.id': '44dc65c2-5fda-4b06-8d7b-7dbcacc644cc',
    'player.id': 'player_1478b88caf17a670',
    'ws.message.type': 'PLAY_CARD'
  },
  status: { code: 0 },
  events: [],
  links: []
}
{"timestamp":"2025-11-27T17:17:32.598Z","level":"info","message":"ws disconnected","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_ddacdca0ffe1825e","eventIndex":null,"context":{"component":"ws-gateway","socketId":"d0995e7c-a66c-409c-b111-87c697ee8ecb","code":1000,"reason":"artillery-run-complete"},"traceId":null,"spanId":null}
{"timestamp":"2025-11-27T17:17:32.604Z","level":"info","message":"ws disconnected","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_f8dbf1152d098b13","eventIndex":null,"context":{"component":"ws-gateway","socketId":"6a3432c8-ef21-4210-af1f-607c466fcddc","code":1000,"reason":"artillery-run-complete"},"traceId":null,"spanId":null}
{"timestamp":"2025-11-27T17:17:32.619Z","level":"info","message":"ws disconnected","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_29792039a4cd005a","eventIndex":null,"context":{"component":"ws-gateway","socketId":"e141da2f-567e-494e-a41c-fbe9d8eb7415","code":1000,"reason":"artillery-run-complete"},"traceId":null,"spanId":null}
{"timestamp":"2025-11-27T17:17:32.633Z","level":"info","message":"ws disconnected","gameId":"44dc65c2-5fda-4b06-8d7b-7dbcacc644cc","playerId":"player_1478b88caf17a670","eventIndex":null,"context":{"component":"ws-gateway","socketId":"edf3a5fd-c930-4d1c-bffc-3504ae8578d6","code":1000,"reason":"artillery-run-complete"},"traceId":null,"spanId":null}
